<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Mess Menu</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  /* ‚Ä¶ your existing styles ‚Ä¶ */

  /* extra styles for new features */
  .hamburger {
    font-size: 1.5rem;
    cursor: pointer;
    background: none;
    border: none;
    color: var(--text);
  }
  .sidebar {
    position: fixed;
    top: 0; left: -300px;
    width: 280px; height: 100%;
    background: var(--card);
    border-right: 1px solid var(--border);
    box-shadow: 4px 0 12px rgba(0,0,0,.15);
    padding: 20px;
    transition: left .3s ease;
    overflow-y: auto;
    z-index: 1000;
  }
  .sidebar.open { left: 0; }
  .sidebar h2 { margin-top: 0; }
  .offline-banner {
    display: none;
    background: #fee2e2;
    color: #991b1b;
    padding: 8px;
    text-align: center;
    font-size: .9rem;
  }
  .footer {
    text-align: center;
    font-size: .8rem;
    color: var(--muted);
    padding: 20px;
  }
</style>
</head>
<body>
  <div id="offlineBanner" class="offline-banner">üì° Network issue</div>

  <header class="hero">
    <div class="topbar">
      <button id="menuBtn" class="hamburger">‚ò∞</button>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <div class="title">Mess Menu</div>
          <div class="tag" id="dayLabel">Loading‚Ä¶</div>
        </div>
      </div>
      <div class="toggle" role="group" aria-label="Theme">
        <button id="lightBtn" title="Light theme" aria-pressed="false">üåû</button>
        <button id="darkBtn" title="Dark theme" aria-pressed="false">üåô</button>
      </div>
    </div>
  </header>

  <aside id="sidebar" class="sidebar">
    <h2>Weekly Menu</h2>
    <div id="weeklyMenu"></div>
  </aside>

  <main class="wrap">
    <section class="grid" id="menuGrid"></section>
  </main>

  <footer class="footer">developed by utkarsh</footer>

<script>
  const messMenu = { /* ‚Ä¶ same menu data ‚Ä¶ */ };

  const dayNames = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
  const now = new Date();
  const todayName = dayNames[now.getDay()];

  document.getElementById('dayLabel').textContent = todayName;
  const grid = document.getElementById('menuGrid');
  const todayMenu = messMenu[todayName];

  const iconMap = { Breakfast:"üç≥", Lunch:"ü•ó", Snacks:"üç™", Dinner:"üçõ" };
  const flagClass = { Breakfast:"breakfast", Lunch:"lunch", Snacks:"snacks", Dinner:"dinner" };

  // today‚Äôs menu cards
  Object.entries(todayMenu).forEach(([meal, items]) => {
    const card = document.createElement('article');
    card.className = 'card';
    card.innerHTML = `
      <div class="flag ${flagClass[meal]}"></div>
      <h3>${iconMap[meal]||"üçΩÔ∏è"} ${meal}</h3>
      <div class="items"><span>${items}</span></div>
    `;
    grid.appendChild(card);
  });

  // weekly menu in sidebar
  const weeklyMenu = document.getElementById('weeklyMenu');
  Object.entries(messMenu).forEach(([day, meals])=>{
    const section = document.createElement('div');
    section.innerHTML = `<h3>${day}</h3>`;
    Object.entries(meals).forEach(([meal, items])=>{
      section.innerHTML += `<p><strong>${meal}:</strong> ${items}</p>`;
    });
    weeklyMenu.appendChild(section);
  });

  // sidebar toggle
  document.getElementById('menuBtn').addEventListener('click',()=>{
    document.getElementById('sidebar').classList.toggle('open');
  });

  // theme toggle (unchanged)
  const root=document.documentElement;
  const prefersDark=window.matchMedia('(prefers-color-scheme: dark)').matches;
  const savedTheme=localStorage.getItem('theme');
  const startDark=savedTheme?(savedTheme==='dark'):prefersDark;
  function applyTheme(isDark){
    root.classList.toggle('dark',isDark);
    document.getElementById('darkBtn').classList.toggle('active',isDark);
    document.getElementById('lightBtn').classList.toggle('active',!isDark);
    document.getElementById('darkBtn').setAttribute('aria-pressed',String(isDark));
    document.getElementById('lightBtn').setAttribute('aria-pressed',String(!isDark));
  }
  applyTheme(startDark);
  document.getElementById('lightBtn').addEventListener('click',()=>{applyTheme(false);localStorage.setItem('theme','light');});
  document.getElementById('darkBtn').addEventListener('click',()=>{applyTheme(true);localStorage.setItem('theme','dark');});

  // offline banner
  const banner = document.getElementById('offlineBanner');
  function updateOnlineStatus() {
    banner.style.display = navigator.onLine ? 'none' : 'block';
  }
  window.addEventListener('online', updateOnlineStatus);
  window.addEventListener('offline', updateOnlineStatus);
  updateOnlineStatus();

  // push notifications
  if ('serviceWorker' in navigator && 'PushManager' in window) {
    navigator.serviceWorker.register('service-worker.js').then(swReg=>{
      console.log("SW registered", swReg);

      // ask permission
      Notification.requestPermission().then(permission=>{
        if(permission === "granted"){
          console.log("Notifications allowed");
          // TODO: get subscription with VAPID key
          // swReg.pushManager.subscribe({ userVisibleOnly:true, applicationServerKey: "<YourPublicVAPIDKeyHere>" })
        }
      });
    });
  }
</script>
</body>
</html>
